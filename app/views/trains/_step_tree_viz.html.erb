<ol class="relative border-l-4 border-gray-300 ml-3 mt-2">
  <% train.steps.review.includes(deployments: [:integration]).order(:step_number).each do |step| %>
    <li class="mb-10 ml-6 last:mb-0">
      <div class="flex items-center">
        <span class="flex absolute -left-5 justify-center items-center w-9 h-6 bg-slate-200 rounded-full ring-8 ring-white"></span>

        <% unless editable %>
          <h3 class="text-xl font-bold items-start justify-start text-slate-800 pl-6"><%= step.name %></h3>
          <span class="text-xs uppercase tracking-wide inline-flex font-medium rounded-full ml-2 bg-slate-200 text-center px-2 py-0.5">
            #<%= step.step_number %>
          </span>
        <% end %>

        <div class="pl-6">
          <%= render partial: "trains/edit_step", locals: { editable: editable, train: train, step: step } %>
        </div>
      </div>

      <div class="pl-6 pt-2">
        <%= render partial: "shared/per_step_metadata", locals: { step: step, step_run: nil, release: nil } %>
      </div>
    </li>
  <% end %>

  <!-- add review button -->
  <% if train.active_run %>
    <li class="mb-10 ml-6 sex">
      <div class="flex items-center mb-8">
        <span class="flex absolute -left-5 justify-center items-center w-9 h-6 bg-slate-200 rounded-full ring-8 ring-white"></span>

        <div class="pl-6">
          <button disabled="disabled" class="btn bg-indigo-500 hover:bg-indigo-600 text-white disabled:border-slate-200 disabled:bg-slate-100 disabled:text-slate-400 disabled:cursor-not-allowed shadow-none">
            <svg class="w-4 h-4 fill-current opacity-50 shrink-0" viewBox="0 0 16 16">
              <path d="M15 7H9V1c0-.6-.4-1-1-1S7 .4 7 1v6H1c-.6 0-1 .4-1 1s.4 1 1 1h6v6c0 .6.4 1 1 1s1-.4 1-1V9h6c.6 0 1-.4 1-1s-.4-1-1-1z"></path>
            </svg>

            <span class="ml-2">Add another review step</span>
          </button>
        </div>
      </div>
    </li>
  <% else %>
    <li class="mb-10 ml-6 last:mb-0">
      <div class="flex items-center">
        <span class="flex absolute -left-5 justify-center items-center w-9 h-6 bg-slate-200 rounded-full ring-8 ring-white"></span>

        <div class="pl-6">
          <%= render partial: "trains/new_step_button", locals: { train: train, kind: "review" } %>
        </div>
      </div>
    </li>
  <% end %>

  <!-- release step-->
  <% release_step = train.steps.release.first %>
  <% if release_step %>
    <li class="mb-10 ml-6 last:mb-0">
      <div class="flex items-center">

        <span class="flex absolute -left-5 justify-center items-center w-9 h-6 bg-slate-200 rounded-full ring-8 ring-white"></span>
        <% unless editable %>
          <h3 class="text-xl font-bold items-start justify-start text-slate-800 pl-6"><%= release_step.name %></h3>
          <span class="text-xs uppercase tracking-wide inline-flex font-medium rounded-full ml-2 bg-slate-200 text-center px-2 py-0.5">
            #<%= release_step.step_number %>
          </span>
        <% end %>


        <div class="pl-6">
          <%= render partial: "trains/edit_step", locals: { editable: editable, train: train, step: release_step } %>
        </div>
      </div>

      <div class="pl-6 pt-2">
        <%= render partial: "shared/per_step_metadata", locals: { step: release_step, step_run: nil, release: nil } %>
      </div>
    </li>
  <% end %>

  <!-- add release button -->
  <% unless train.has_release_step? %>
    <li class="mb-10 ml-6 last:mb-0">
      <div class="flex items-center">
        <span class="flex absolute -left-5 justify-center items-center w-9 h-6 bg-slate-200 rounded-full ring-8 ring-white"></span>

        <div class="pl-6">
          <%= render partial: "trains/new_step_button", locals: { train: train, kind: "release" } %>
        </div>
      </div>
    </li>
  <% end %>
</ol>
