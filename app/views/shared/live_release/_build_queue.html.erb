<section>
  <% commits = build_queue.commits %>
  <% commits_count = commits.size %>
  <% if commits.present? %>
    <div class="flex justify-between w-full items-center">
      <div>
        <h2 class="text-2xl text-slate-800 font-bold">Build Queue</h2>
        <span class="text-sm text-slate-400"><%= commits_count %>&nbsp;commit(s) in the queue. Commits will be applied in <%= time_in_words(build_queue.scheduled_at) %>.</span>
      </div>
      <div class="text-left">
        <% if release.committable? %>
          <%= authz_button_to :blue, "Apply commits now!", apply_release_build_queue_path(release, build_queue), class: "btn-sm", data: { turbo_confirm: "This will trigger steps for the HEAD of the queue, are you sure?" } %>
        <% else %>
          <%= authz_button_to :disabled, "Apply commits now!", apply_release_build_queue_path(release, build_queue), class: "btn-sm" %>
        <% end %>
      </div>
    </div>
    <table class="table-auto w-full mt-6">
      <thead class="text-xs font-semibold uppercase text-slate-500 bg-slate-50 border-t border-b border-slate-200">
      <tr>
        <th class="px-2 py-3 whitespace-nowrap">
          <div class="font-semibold text-left">commits</div>
        </th>
      </tr>
      </thead>
      <tbody class="text-sm border-b last:border-b-0">
      <% commits.each_with_index do |commit, index| %>
        <tr>
          <td class="py-4 whitespace-nowrap">
            <%= link_to_external commit.message.truncate(150), commit.url, class: "underline font-medium" %>
            <span class="text-xs uppercase tracking-wide inline-flex font-medium bg-slate-200 text-slate-600 rounded-full text-center px-2 py-0.5">
            #<%= commits_count - index %>
          </span>

            <div class="text-slate-500">
              <code><%= commit.short_sha %></code> â€¢ <%= ago_in_words commit.timestamp %>
            </div>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  <% else %>
    <div>
      <h2 class="text-2xl text-slate-800 font-bold">Build Queue</h2>
      <span class="text-sm text-slate-400">No commits in the queue.</span>
    </div>
  <% end %>
</section>
