<% if current_organization.teams.any? %>
  <section>
    <%= render partial: "shared/live_release/section_title", locals: { heading: "Team Analysis", subheading: nil } %>
    <div class="mt-6">
      <%= render ChartComponent.new({ data: commits.count_by_team,
                                      type: "polar-area",
                                      value_format: "number",
                                      name: "Team Contribution",
                                      title: "Team Contributions",
                                      scope: "number of commits to the release",
                                      help_text: "",
                                      show_x_axis: false,
                                      show_y_axis: false }, icon: "pie_chart.svg") %>
    </div>
  </section>
<% end %>

<% if @mid_release_prs.exists? %>
  <section>
    <%= render partial: "shared/live_release/section_title", locals: { heading: "Ongoing Work", subheading: nil } %>
    <div class="w-full mt-6" data-controller="reveal" data-reveal-toggle-keys-value="p">
      <div class="text-xs font-semibold uppercase text-slate-500 bg-slate-50 border-t border-b border-slate-200">
        <%= toggle_for(false, full_width: true) do %>
          <div class="text-xs font-semibold uppercase text-slate-500 group-hover:text-slate-800 mr-1">
            open pull requests (<%= pull_requests.open.size %>)
          </div>
        <% end %>
      </div>

      <div data-reveal class="col-span-2">
        <div class="flex flex-row gap-x-2 mt-4 text-sm">
          <%= decorated_link_to :neutral, "View all (#{@mid_release_prs.size}) on #{@release.vcs_provider.display} ↗", @release.pull_requests_url, { target: "_blank", rel: "nofollow noopener" } %>
          <% if @mid_release_prs.open.exists? %>
            <%= decorated_link_to :neutral, "View open (#{@mid_release_prs.open.size}) on #{@release.vcs_provider.display} ↗", @release.pull_requests_url(true), { target: "_blank", rel: "nofollow noopener" } %>
          <% end %>
        </div>

        <div class="max-h-100 overflow-x-hidden hover:overflow-x-auto overflow-y-hidden hover:overflow-y-scroll grid grid-cols-1 gap-3 mt-3">
          <% @mid_release_prs.open.each do |pr| %>
            <%= render partial: "shared/live_release/pull_request_thin", locals: { pr:, title_size: 70 } %>
          <% end %>
        </div>
      </div>
    </div>
  </section>
<% end %>
