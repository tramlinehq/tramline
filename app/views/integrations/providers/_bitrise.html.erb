<% form_url = app_bitrise_integration_path(app) %>

<%= form_with(model: [app, integration], url: form_url, builder: EnhancedFormHelper::AuthzForm) do |form| %>
  <%= form.hidden_field :category, value: category %>

  <%= form.fields_for :providable do |subform| %>
    <%= subform.hidden_field :type, value: integration.providable_type %>
    <%= subform.text_field :access_token, placeholder: "Paste here..." %>
  <% end %>

  <div class="flex justify-start items-center my-5" data-controller="reveal">
    <%= form.authz_submit "Create",
                          "plus.svg",
                          scheme: :default,
                          size: :xs,
                          html_options: { data: { action: "reveal#toggle" } } %>

    <div class="ml-5">
      <div hidden data-reveal>
        <%= render V2::LoadingIndicatorComponent.new(text: "Verifying...") %>
      </div>
    </div>
  </div>
<% end %>

<%= link_to_external "How to add a personal access token?",
                     "https://devcenter.bitrise.io/en/accounts/personal-access-tokens.html",
                     class: "underline text-slate-500 items-end" %>
